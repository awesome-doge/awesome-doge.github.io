---
layout: post
title: .onion 生成 步驟(tor v2 )
date: 2018-01-22 17:59:19
tags: [tor, tor address]
categories: Tor Project
---

看了一些hidden services 的文獻，大致把.onion的域名生成的步驟畫成下面的圖片，之前有再研究比特幣地址生成的我，發現這樣的生成.onion域名的過程，與比特幣地址生成有相當類似的部分，因為都是式Random生成私鑰，經過私鑰轉公鑰的算法，經過HASH，最後在經過BASE重新編碼，不難發現概念是一樣的。所以誕生出來的比特幣地址或是.onion域名都有它的隨機性。

![.onion 域名 生成流程](/image/tor14.png)

<!-- more --> 

### 原文

```
3. .onion

  SYNTAX:  [digest].onion
           [ignored].[digest].onion

  The digest is the first eighty bits of a SHA1 hash of the identity key for
  a hidden service, encoded in base32.

  When Tor sees an address in this format, it tries to look up and connect to
  the specified hidden service.  See rend-spec.txt for full details.

  The "ignored" portion of the address is intended for use in vhosting, and
  is supported in Tor 0.2.4.10-alpha and later.
```

只要有錢有時間就可以爆破出一個美麗的域名或是比特幣地址。

不難發現洋蔥網路所採用的密碼演算法都相當的過氣，如SHA-1、RSA-1024，當然Tor Project 也意識到這樣的問題，在最新版本的v3[2]中，已經闡述了會將SHA-1換成SHA-3，RSA-1024換成橢圓曲線。

> Better crypto (replaced SHA1/DH/RSA1024 with SHA3/ed25519/curve25519)

#### Facebook
他們使用超過500,000個核心，耗資 US$100,000，耗時一周來反復生成.onion域名，產物" facebookcorewwwi.onion"。

#### BlockChain.info
花費了200–300美元，大約24小時使用AWS G1實例和六個ATI 來創建自己的.onion域名，產物"blockchainbdgpzk.onion"。

#### ExpressVPN
一般的電腦耗時兩周，產物"expressobutiolem.onion"。

[1]https://www.expressvpn.com/blog/how-to-create-a-onion-address/

[2]https://blog.torproject.org/tor-0329-released-we-have-new-stable-series
